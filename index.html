<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskFlow Simple</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body data-theme="light">

    <nav class="sidebar">
        <div class="logo">TaskFlow</div>
        <div class="nav-btn active" id="nav-board" onclick="switchView('board')">Board</div>
        <div class="nav-btn" id="nav-analytics" onclick="switchView('analytics')">Analytics</div>
        <div class="nav-btn" onclick="alert('Copied')">Invite Team</div>

        <div style="margin-top:auto;">
            <div class="nav-btn" onclick="toggleTheme()">Dark Mode</div>
            <div class="nav-btn" onclick="resetData()">Reset</div>
        </div>
    </nav>

    <main class="main-content">
        <header>
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search tasks..." onkeyup="filterTasks()">
            </div>
            <button class="btn btn-primary" onclick="openModal()">+ New Task</button>
        </header>

        <div id="view-board">
            <div class="column" id="col-todo" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="col-header"><span>To Do</span> <span id="c-todo" style="color:var(--text-muted)">0</span>
                </div>
                <div class="task-list" id="list-todo"></div>
            </div>
            <div class="column" id="col-progress" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="col-header"><span>In Progress</span> <span id="c-progress"
                        style="color:var(--text-muted)">0</span></div>
                <div class="task-list" id="list-progress"></div>
            </div>

            <div class="column" id="col-incomplete" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="col-header"><span style="color:var(--danger)">Incomplete</span> <span id="c-incomplete"
                        style="color:var(--text-muted)">0</span></div>
                <div class="task-list" id="list-incomplete"></div>
            </div>
            <div class="column" id="col-done" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="col-header"><span style="color:var(--success)">Done</span> <span id="c-done"
                        style="color:var(--text-muted)">0</span></div>
                <div class="task-list" id="list-done"></div>
            </div>
        </div>

        <div id="view-analytics">
            <h2 style="font-size:1.2rem; margin-bottom:20px;">Performance</h2>
            <div class="stats-grid">
                <div class="stat-box">
                    <div style="color:var(--text-muted); font-size:0.85rem">Total Tasks</div>
                    <div class="stat-val" id="an-total">0</div>
                </div>
                <div class="stat-box">
                    <div style="color:var(--text-muted); font-size:0.85rem">On-Time Rate</div>
                    <div class="stat-val" style="color:var(--success)" id="an-ontime">0%</div>
                </div>
                <div class="stat-box">
                    <div style="color:var(--text-muted); font-size:0.85rem">Missed</div>
                    <div class="stat-val" style="color:var(--danger)" id="an-late">0</div>
                </div>
                <div class="stat-box">
                    <div style="color:var(--text-muted); font-size:0.85rem">Active Members</div>
                    <div class="stat-val">4</div>
                </div>
            </div>

            <h3 style="font-size:1rem;">Distribution</h3>
            <div class="chart-section">
                <div class="chart-container">
                    <canvas id="taskPieChart" width="270" height="270"></canvas>
                </div>
                <div class="chart-legend" id="chart-legend"></div>
            </div>
            <div class="missed-box">
                <h3 style="font-size:1rem; margin-top:0; color:var(--danger)">Moved to Incomplete</h3>
                <ul id="missed-log" class="missed-list"></ul>
            </div>
        </div>
    </main>

    <div class="modal-overlay" id="task-modal">
        <div class="modal-box">
            <h2 style="margin-top:0; font-size:1.2rem;">Task Details</h2>
            <input type="hidden" id="t-id">

            <label style="font-size:0.85rem; display:block; margin-bottom:5px;">Task Title</label>
            <input type="text" id="t-title" placeholder="Enter task name...">

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                <div>
                    <label style="font-size:0.85rem; display:block; margin-bottom:5px;">Assign To</label>
                    <select id="t-team" multiple>
                        <option value="Unassigned">Unassigned</option>
                        <option value="Alex Design">Alex (Design)</option>
                        <option value="Sam Dev">Sam (Dev)</option>
                        <option value="Jordan PM">Jordan (PM)</option>
                        <option value="Riley QA">Riley (QA)</option>
                        <option value="Project Lead">Project Lead</option>
                    </select>
                </div>
                <div>
                    <label style="font-size:0.85rem; display:block; margin-bottom:5px;">Due Date</label>
                    <input type="datetime-local" id="t-due">
                </div>
            </div>

            <h4 style="margin:15px 0 5px 0; font-size:0.9rem;">History</h4>
            <div id="activity-log-display">No activity yet.</div>

            <div style="margin-top:20px; display:flex; justify-content:flex-end; gap:10px;">
                <button class="btn"
                    style="background:transparent; color:var(--text-muted); border:1px solid var(--border-color)"
                    onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveTask()">Save</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>